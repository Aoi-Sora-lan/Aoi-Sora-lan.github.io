"use strict";(globalThis["webpackChunkbangumi_modern"]=globalThis["webpackChunkbangumi_modern"]||[]).push([[247],{5283:(e,t,a)=>{a.d(t,{Z:()=>i});var s=a(6081);const i={fast_axios_get(e,t){s.Z.get(e,{"User-Agent":"AoiSora/BangumiByVue (https://github.com/Aoi-Sora-lan/BangumiByVue)"}).then((({data:e})=>{t(e)}))},fast_axios_post(e,t,a){s.Z.post(e,t,{"User-Agent":"AoiSora/BangumiByVue (https://github.com/Aoi-Sora-lan/BangumiByVue)"}).then((({data:e})=>{a(e)}))},get_subject(e,t){this.fast_axios_get("https://api.bgm.tv/v0/subjects/"+e.toString(),t)},get_episodes(e,t){this.fast_axios_get("https://api.bgm.tv/v0/episodes?subject_id="+e.toString()+"&type=0&limit=100&offset=0",t)},get_characters(e,t){this.fast_axios_get("https://api.bgm.tv/v0/subjects/"+e.toString()+"/characters",t)},get_character(e,t){this.fast_axios_get("https://api.bgm.tv/v0/characters/"+e.toString(),t)},get_episode(e,t){this.fast_axios_get("https://api.bgm.tv/v0/episodes/"+e.toString(),t)},search_normal(e,t,a,s){this.fast_axios_get("https://api.bgm.tv/search/subject/"+encodeURI(e)+"?type="+t+"&responseGroup=small&start="+a+"&max_results=10",s)}}},3727:(e,t,a)=>{a.d(t,{Z:()=>s});a(2879),a(5283);const s={get_characters_from_data(e){let t=[],a=e.length;console.log(a);for(let s=0;s<a;s++){if(s>=5)break;let a={};a.image_url=e[s].images.grid,a.id=e[s].id,a.character_name=e[s].name,a.person_name=e[s].actors[0].name,a.character_relation=e[s].relation,a.actor_img=e[s].actors[0].images.grid,t.push(a)}return t}}},5311:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(1809);const i=(0,s.Q_)("counter",{state:()=>({name:"",counter:1}),getters:{doubleCount(e){return 2*e.counter},get_name(e){return e.name}},actions:{increment(){this.counter++},set_name(e){this.name=e}}})},8989:(e,t,a)=>{a.d(t,{Z:()=>f});var s=a(9835),i=a(6970);const l=["src"];function n(e,t,a,n,o,r){const c=(0,s.up)("q-avatar"),d=(0,s.up)("q-item-section"),m=(0,s.up)("q-item-label"),h=(0,s.up)("q-badge"),_=(0,s.up)("q-item"),p=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(p,{class:"my-card q-ma-xs",flat:"",bordered:"",style:{"max-width":"280px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{class:"flex-center q-pa-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"flex",avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s._)("img",{style:{width:"150px",height:"150px"},src:a.character_data.image_url},null,8,l)])),_:1})])),_:1}),(0,s.Wm)(d,{class:"flex"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{style:{"text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap"}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(a.character_data.character_name),1)])),_:1}),(0,s.Wm)(m,{caption:"",style:{"text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap"}},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{outline:"",color:"secondary",label:"CV"}),(0,s.Uk)(" "+(0,i.zw)(a.character_data.person_name),1)])),_:1})])),_:1})])),_:1})])),_:1})}const o={name:"chara_card",props:{character_data:{image_url:String,character_name:String,person_name:String}}};var r=a(1639),c=a(4458),d=a(490),m=a(6749),h=a(1357),_=a(3115),p=a(990),u=a(9984),g=a.n(u);const w=(0,r.Z)(o,[["render",n]]),f=w;g()(o,"components",{QCard:c.Z,QItem:d.Z,QItemSection:m.Z,QAvatar:h.Z,QItemLabel:_.Z,QBadge:p.Z})},5247:(e,t,a)=>{a.r(t),a.d(t,{default:()=>xe});var s=a(9835),i=a(6970);const l={class:"row flex-center",style:{width:"100%"}},n={class:"q-py-md flex",style:{"max-width":"1000px"}},o={class:"row"},r={class:"col-12 col-md-3"},c={class:"row q-mt-sm"},d={class:"row q-ma-md"},m={class:"col-12 col-md-9 q-pa-sm q-pl-md"},h=(0,s._)("div",{class:"row text-h5"},"番剧简介",-1),_={class:"row text-body1 q-mb-md"},p={key:0,class:"row"},u={class:"col-12"},g=(0,s._)("div",{class:"row text-h5"},"番剧列表",-1),w={class:"row q-mb-md"},f={class:"text-h6"},x={class:"text-subtitle2"},b=(0,s._)("div",{class:"row text-h5"},"角色列表",-1),y={class:"row q-pb-lg"},v=(0,s._)("div",{class:"row text-h5"},"大众标签",-1),k=(0,s._)("div",{class:"row"},null,-1);function q(e,t,a,q,Z,W){const S=(0,s.up)("q-img"),C=(0,s.up)("info-box"),Q=(0,s.up)("q-separator"),z=(0,s.up)("video-card"),D=(0,s.up)("q-card-section"),j=(0,s.up)("q-card"),B=(0,s.up)("chara_card"),A=(0,s.up)("tag-box");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("div",n,[(0,s._)("div",o,[(0,s._)("div",r,[(0,s._)("div",c,[(0,s.Wm)(S,{class:"q-ma-md",src:Z.pic_src},null,8,["src"])]),(0,s._)("div",d,[(0,s.Wm)(C,{anime_data:Z.anime_data},null,8,["anime_data"])])]),(0,s._)("div",m,[h,(0,s.Wm)(Q,{class:"q-my-md"}),(0,s._)("div",_,(0,i.zw)(Z.anime_desc),1),2===Z.page_type?((0,s.wg)(),(0,s.iD)("div",p,[(0,s._)("div",u,[(0,s.Wm)(z,{episodes:Z.select_episodes,search_name:Z.name},null,8,["episodes","search_name"])])])):(0,s.kq)("",!0),g,(0,s.Wm)(Q,{class:"q-my-md"}),(0,s._)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Z.episode_data,(e=>((0,s.wg)(),(0,s.j4)(j,{class:(0,i.C_)(e.ep===Z.select_episodes?"bg-blue-1":""),key:e,flat:"",bordered:"",style:{width:"200px",margin:"5px 5px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(D,{onClick:t=>Z.select_episodes=e.ep,style:{padding:"5px 10px"}},{default:(0,s.w5)((()=>[(0,s._)("div",f,(0,i.zw)(e.ep),1),(0,s._)("div",x,(0,i.zw)(e.name_cn),1)])),_:2},1032,["onClick"])])),_:2},1032,["class"])))),128))]),b,(0,s.Wm)(Q,{class:"q-my-md"}),(0,s._)("div",y,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Z.anime_characters,(e=>((0,s.wg)(),(0,s.j4)(B,{key:e,character_data:e,style:{width:"200px"}},null,8,["character_data"])))),128))]),v,(0,s.Wm)(Q,{class:"q-my-md"}),(0,s.Wm)(A,{anime_data:Z.anime_data},null,8,["anime_data"])])]),k])])}a(2879);function Z(e,t,a,l,n,o){const r=(0,s.up)("q-item-label"),c=(0,s.up)("q-item-section"),d=(0,s.up)("q-item"),m=(0,s.up)("q-list");return(0,s.wg)(),(0,s.j4)(m,{bordered:"",separator:""},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.anime_infos,(e=>((0,s.wg)(),(0,s.j4)(d,{key:e},{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.key),1)])),_:2},1024),"object"!==typeof e.value?((0,s.wg)(),(0,s.j4)(r,{key:0,caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.value),1)])),_:2},1024)):((0,s.wg)(!0),(0,s.iD)(s.HY,{key:1},(0,s.Ko)(e.value,(e=>((0,s.wg)(),(0,s.iD)("div",{key:e},[(0,s.Wm)(r,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.v),1)])),_:2},1024)])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})}const W={name:"InfoBox",props:{anime_data:{type:Object,required:!0}},data(){return{anime_infos:[]}},created(){this.$watch((()=>this.anime_data),((e,t)=>{console.log("child-watch-on"),0!=this.anime_infos.length&&this.anime_infos.splice(0);let a=this.anime_data;for(let s in a.infobox)this.anime_infos.push(a.infobox[s]);console.log(this.anime_infos)}))},mounted(){console.log("child-mount-on")}};var S=a(1639),C=a(3246),Q=a(490),z=a(6749),D=a(3115),j=a(9984),B=a.n(j);const A=(0,S.Z)(W,[["render",Z]]),I=A;B()(W,"components",{QList:C.Z,QItem:Q.Z,QItemSection:z.Z,QItemLabel:D.Z});var U=a(3727),V=a(5283),O=(a(6663),a(8989)),L=a(5311);const H={class:"row flex-center q-pa-md"},Y=["src"],K={class:"row flex-center q-pa-md",style:{width:"200px"}},T={class:"col-12"},P={class:"row fa-less-than-equal"},E={class:"row"},$={class:"row flex-center"},M={style:{width:"90%"},class:"text-body2 text-center"},F={class:"col-9",style:{height:"100%"}};function R(e,t,a,l,n,o){const r=(0,s.up)("q-btn"),c=(0,s.up)("q-item-section"),d=(0,s.up)("q-item"),m=(0,s.up)("q-list"),h=(0,s.up)("q-menu"),_=(0,s.up)("q-knob"),p=(0,s.up)("q-card"),u=(0,s.up)("q-page-sticky"),g=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",H,[(0,s._)("iframe",{id:"eframe",class:"col-12",style:{height:"400px"},referrerPolicy:"no-referrer",src:n.video_src,allowfullscreen:"allowfullscreen",mozallowfullscreen:"mozallowfullscreen",msallowfullscreen:"msallowfullscreen",oallowfullscreen:"oallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen"},null,8,Y)]),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s._)("div",K,[(0,s.Wm)(p,{class:"col-12 q-pa-md bg-blue-2"},{default:(0,s.w5)((()=>[(0,s._)("div",T,[(0,s._)("div",P,[(0,s.Wm)(r,{href:n.video_src,rel:"noreferrer",target:"_blank",class:"col-12 bg-pink-3 text-white text-body1 q-mb-md",push:"",style:{"text-decoration":"none"}},{default:(0,s.w5)((()=>[(0,s.Uk)("如果不能播放，请点这个")])),_:1},8,["href"])]),(0,s._)("div",E,[(0,s.Wm)(r,{onClick:o.fetch_the_anime,push:"",label:n.select_anime,class:"col-12 bg-pink-3 text-h5 text-white"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,{style:{"min-width":"100px"}},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.text_list,(e=>(0,s.wy)(((0,s.wg)(),(0,s.j4)(d,{onClick:t=>o.select_the_anime(e),clickable:"",key:e},{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e),1)])),_:2},1024)])),_:2},1032,["onClick"])),[[g]]))),128))])),_:1})])),_:1})])),_:1},8,["onClick","label"])]),(0,s._)("div",$,[(0,s.Wm)(_,{min:1,max:6,"inner-min":1,modelValue:n.lines,"onUpdate:modelValue":t[0]||(t[0]=e=>n.lines=e),"show-value":"",size:"80px",thickness:.25,color:"blue-3","track-color":"grey-3",class:"q-ma-md"},{default:(0,s.w5)((()=>[(0,s._)("div",M,(0,i.zw)("频道："+n.lines.toString()),1)])),_:1},8,["modelValue"]),(0,s._)("div",F,[(0,s.Wm)(r,{onClick:o.play_the_anime,push:"",label:"播放→V→",style:{width:"100%"},class:"bg-pink-3 text-h5 text-white"},null,8,["onClick"])])])])])),_:1})])])),_:1})],64)}var G=a(6081);const N={name:"VideoCard",props:{search_name:String,episodes:Number},data(){return{select_anime:"匹配番剧  OVO",lines:2,video_src:"",text_list:[],href_list:[]}},methods:{jump_button(){alert(this.select_anime)},fetch_the_anime(){this.text_list.push("加载中..."),G.Z.get("https://www.agedm.org/search?query="+this.search_name.toString()).then((({data:e})=>{this.text_list.length>0&&(this.text_list.splice(0),this.href_list.splice(0));const t=new DOMParser,a=t.parseFromString(e,"text/html"),s=a.getElementById("cata_video_list").children[0],i=s.childElementCount;for(let l=0;l<i;l++){let e=s.children[l].children[0].children[0].children[0].children[0].getAttribute("href").toString(),t=s.children[l].children[0].children[0].children[0].children[0].getAttribute("title").toString();this.text_list.push(t),this.href_list.push(e)}console.log(this.text_list)}))},select_the_anime(e){this.select_anime=e},play_the_anime(){const e=(this.href_list[this.text_list.indexOf(this.select_anime)]+"/"+this.lines+"/"+this.episodes).replace("detail","play"),t=e.replace("http","https");G.Z.get(t).then((({data:e})=>{console.log("test");const t=new DOMParser,a=t.parseFromString(e,"text/html"),s=a.querySelector("iframe");console.log(s),this.video_src=s.getAttribute("src"),console.log(this.video_src)}))}},mounted(){const e=document.getElementById("eframe");e.onload=function(){console.log(e.contentWindow.Vurl)}}};var J=a(627),X=a(4458),ee=a(8879),te=a(4735),ae=a(2245),se=a(2146);const ie=(0,S.Z)(N,[["render",R]]),le=ie;B()(N,"components",{QPageSticky:J.Z,QCard:X.Z,QBtn:ee.Z,QMenu:te.Z,QList:C.Z,QItem:Q.Z,QItemSection:z.Z,QKnob:ae.Z}),B()(N,"directives",{ClosePopup:se.Z});const ne={class:"q-pt-xs",style:{width:"600px"}};function oe(e,t,a,l,n,o){const r=(0,s.up)("text-h3"),c=(0,s.up)("text-caption"),d=(0,s.up)("q-chip");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{class:"text-weight-bold"},{default:(0,s.w5)((()=>[(0,s.Uk)("大家将"+(0,i.zw)(n.anime_name)+"标注为",1)])),_:1}),(0,s._)("div",ne,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.anime_tags,(e=>((0,s.wg)(),(0,s.iD)("small",{key:e},[(0,s.Wm)(d,{class:"bg-pink-3 text-white",square:"",clickable:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.name)+" ",1),(0,s.Wm)(c,{class:"q-pl-md text-white"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.count),1)])),_:2},1024)])),_:2},1024)])))),128)),(0,s.Wm)(d,{class:"bg-pink-3",square:"",clickable:"",onClick:e.onclick},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"text-white"},{default:(0,s.w5)((()=>[(0,s.Uk)("更多+")])),_:1})])),_:1},8,["onClick"])])],64)}const re={name:"TagBox",props:{anime_data:{type:Object,required:!0}},data(){return{anime_tags:[],anime_name:""}},created(){this.$watch((()=>this.anime_data),((e,t)=>{0!=this.anime_tags.length&&this.anime_tags.splice(0);let a=this.anime_data;this.anime_name=a.name;for(let s in a.tags)this.anime_tags.push(a.tags[s]);console.log(this.anime_tags)}))},mounted(){console.log("child-mount-on")}};var ce=a(7691);const de=(0,S.Z)(re,[["render",oe]]),me=de;B()(re,"components",{QChip:ce.Z});const he={name:"StarBox",props:{anime_data:{type:Object,required:!0}},data(){return{img:"",score:"",rating:null,tag:"",rank:0,yData:[2,2,0,11,55,102,59,7,1,2],xData:[10,9,8,7,6,5,4,3,2,1],myChartStyle:{width:"190px",height:"120px",margin:"0 20px",top:0}}},methods:{init(){console.log(this.rating),this.yData=Object.keys(this.rating).map((e=>this.rating[e])).reverse(),console.log(this.yData),this.score>8.5?this.tag="神作":this.score>7.5?this.tag="力荐":this.score>6.5?this.tag="推荐":this.tag="不过不失",console.log(this.tag);const e={color:"#5c5c64",grid:{left:0,top:0,bottom:0,right:0,containLabel:!0},title:{text:this.rank+"votes",right:0,top:0,textStyle:{fontSize:17,color:"rgb(207,207,207)"}},legend:{right:0,padding:0},xAxis:{data:this.xData,axisTick:{show:!1},axisLabel:{show:!0,textStyle:{color:"#fff"}}},yAxis:{axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},series:[{type:"bar",data:this.yData,emphasis:{itemStyle:{color:"#ababab"}}}],tooltip:{trigger:"item",borderColor:"gray",borderWidth:1,textStyle:{color:"#522e4a",fontSize:"16"}}};let t=a(4872);const s=t.init(document.getElementById("mychart"));s.setOption(e),window.addEventListener("resize",(()=>{s.resize()}))},updateChartView(){if(!this.chart)return;const e=this.assembleDataToOption();console.log(e),this.chart.setOption(e,!0)},handleWindowResize(){this.chart&&this.chart.resize()}},created(){this.$watch((()=>this.anime_data),((e,t)=>{console.log("child-watch-on"),this.score=this.anime_data.rating.score,console.log(this.anime_data),this.rating=this.anime_data.rating.count,console.log(this.rating),this.rank=this.anime_data.rating.rank,console.log(this.rank),this.init()}))},mounted(){console.log(11)}};var _e=a(1357);B()(he,"components",{QAvatar:_e.Z});const pe={name:"AnimePage",components:{TagBox:me,VideoCard:le,chara_card:O.Z,InfoBox:I},methods:{update_page(){this.id=this.$route.params.id,V.Z.get_subject(this.id,(e=>{this.anime_data=e,this.pic_src=e.images.common,this.anime_desc=e.summary;let t=(0,L.A)();""!=e.name_cn?t.name=e.name_cn:t.name=e.name,this.name=t.name,this.page_type=e.type,console.log(this.name)})),V.Z.get_characters(this.id,(e=>{this.anime_characters=U.Z.get_characters_from_data(e)})),V.Z.get_episodes(this.id,(e=>{0!==this.episode_data.length&&this.episode_data.splice(0);for(let t in e.data)""===e.data[t].name_cn&&(e.data[t].name_cn=e.data[t].name),this.episode_data.push(e.data[t])}))}},data(){return{id:0,video_src:"",pic_src:"",anime_data:null,anime_desc:"",name:"",page_type:0,anime_characters:[],episode_data:[],store:null,select_episodes:1}},mounted(){this.update_page()}};var ue=a(335),ge=a(926),we=a(3190);const fe=(0,S.Z)(pe,[["render",q]]),xe=fe;B()(pe,"components",{QImg:ue.Z,QSeparator:ge.Z,QCard:X.Z,QCardSection:we.Z})}}]);